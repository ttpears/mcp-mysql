# Smithery.ai Test Profile Configuration
# This configuration allows Smithery to connect to the MySQL MCP server for tool scanning

name: test
description: "Test profile for MySQL MCP server tool scanning"

# Environment variables for test MySQL connection
environment:
  MYSQL_HOST: "demo-mysql.smithery.ai"
  MYSQL_PORT: "3306" 
  MYSQL_USER: "demo_user"
  MYSQL_PASSWORD: "demo_password"
  MYSQL_DATABASE: "sample_analytics"
  MYSQL_SSL: "false"

# Server configuration
server:
  command: ["npm", "start"]
  transport: stdio
  timeout: 30s
  
# Test configuration
test:
  # Basic connectivity test
  connection_test: true
  
  # Tool scanning configuration
  scan_tools: true
  scan_timeout: 60s
  
  # Sample test calls to verify tools work
  sample_calls:
    - tool: "mysql_discover_analytics"
      parameters:
        focus_area: "general"
        include_recommendations: true
        
    - tool: "mysql_query" 
      parameters:
        query: "SHOW TABLES"
        
    - tool: "mysql_schema"
      parameters:
        include_relationships: true

# Demo database setup instructions
demo_setup:
  description: "Instructions for setting up demo MySQL instance for tool scanning"
  sql_setup: |
    -- Create demo database and tables for testing
    CREATE DATABASE IF NOT EXISTS sample_analytics;
    USE sample_analytics;
    
    -- Demo users table
    CREATE TABLE users (
      id INT AUTO_INCREMENT PRIMARY KEY,
      email VARCHAR(255) NOT NULL,
      name VARCHAR(100),
      created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
      status ENUM('active', 'inactive') DEFAULT 'active'
    );
    
    -- Demo events table  
    CREATE TABLE events (
      id INT AUTO_INCREMENT PRIMARY KEY,
      user_id INT,
      event_type VARCHAR(50),
      event_data JSON,
      created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
      FOREIGN KEY (user_id) REFERENCES users(id)
    );
    
    -- Insert sample data
    INSERT INTO users (email, name) VALUES 
    ('alice@example.com', 'Alice Johnson'),
    ('bob@example.com', 'Bob Smith'),
    ('charlie@example.com', 'Charlie Brown');
    
    INSERT INTO events (user_id, event_type, event_data) VALUES
    (1, 'login', '{"source": "web"}'),
    (1, 'page_view', '{"page": "/dashboard"}'),
    (2, 'login', '{"source": "mobile"}'),
    (3, 'signup', '{"campaign": "social"}');
    
    -- Create demo read-only user for testing
    CREATE USER 'demo_user'@'%' IDENTIFIED BY 'demo_password';
    GRANT SELECT, SHOW VIEW ON sample_analytics.* TO 'demo_user'@'%';
    FLUSH PRIVILEGES;